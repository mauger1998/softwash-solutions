---
import Hero from '../components/Hero.astro'
import Layout from '../layouts/Layout.astro'
import { getSanity } from '../lib/api'
import OurWork from '../components/sections/OurWork.astro'
import Testimonials from '../components/sections/Testimonials.astro'
import Cta from '../components/sections/Cta.astro'
import ServicesList from '../components/ServicesList.astro'
import ThreeIconCards from '../components/sections/ThreeIconCards.astro'

const returnedSections = await getSanity(`*[_type == 'home']`)
const services = await getSanity(`*[_type == 'services'] | order(orderRank asc)`)
const sections = returnedSections[0].sections
---

<Layout>
	{
		sections.map((section, index) => {
			let components = []
			if (index === 2) {
				components.push(<ServicesList services={services} />)
			}
			switch (section._type) {
				case 'hero':
					components.push(<Hero image={section.image} title={section.title} />)
					break
				case 'ourWork':
					components.push(<OurWork title={section.title} projects={section.projects} />)
					break
				case 'testimonials':
					components.push(
						<Testimonials title={section.title} testimonials={section.testimonials} />
					)
					break
				case 'threeCards':
					components.push(
						<ThreeIconCards
							cards={section.cards}
							title={section.title.title}
							text={section.title.text}
						/>
					)
					break
			}
			return components
		})
	}
</Layout>
